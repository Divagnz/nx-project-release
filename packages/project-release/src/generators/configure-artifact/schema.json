{
  "$schema": "http://json-schema.org/schema",
  "cli": "nx",
  "$id": "ConfigureArtifact",
  "title": "Configure Artifact Creation",
  "description": "Add artifact creation target to a project",
  "type": "object",
  "properties": {
    "project": {
      "type": "string",
      "description": "Project name",
      "x-prompt": "Which project do you want to configure artifact creation for?",
      "$default": {
        "$source": "projectName"
      }
    },
    "projects": {
      "type": "array",
      "description": "Multiple projects to configure (batch mode)",
      "items": {
        "type": "string"
      }
    },
    "sourceDir": {
      "type": "string",
      "description": "Source directory to archive (supports {projectName} template variable)",
      "x-prompt": "Source directory to archive? (use {projectName} as placeholder)"
    },
    "format": {
      "type": "string",
      "description": "Archive format",
      "enum": ["zip", "tar", "tgz", "tar.gz"],
      "default": "tgz",
      "x-prompt": {
        "message": "Which archive format?",
        "type": "list",
        "items": [
          { "value": "zip", "label": "ZIP (.zip)" },
          { "value": "tgz", "label": "Gzipped Tar (.tgz)" },
          { "value": "tar.gz", "label": "Gzipped Tar (.tar.gz)" },
          { "value": "tar", "label": "Tar (.tar)" }
        ]
      }
    },
    "artifactName": {
      "type": "string",
      "description": "Artifact filename template",
      "default": "{projectName}-{version}.{extension}"
    },
    "dependsOn": {
      "type": "array",
      "description": "Targets to run before artifact creation",
      "items": {
        "type": "string"
      },
      "default": ["build"]
    },
    "exclude": {
      "type": "array",
      "description": "Patterns to exclude from artifact",
      "items": {
        "type": "string"
      },
      "examples": [
        ["**/*.map", "**/*.spec.ts"],
        ["**/test/**", "**/*.test.js"]
      ]
    },
    "outputDir": {
      "type": "string",
      "description": "Where to place the artifact (supports template variables: {projectName}, {version})",
      "default": "dist/artifacts",
      "x-prompt": "Output directory for artifacts?"
    },
    "include": {
      "type": "array",
      "description": "Glob patterns to include (default: all files)",
      "items": {
        "type": "string"
      },
      "default": ["**/*"]
    },
    "compressionLevel": {
      "type": "number",
      "description": "Compression level (0-9, where 9 is maximum compression)",
      "default": 6,
      "minimum": 0,
      "maximum": 9
    },
    "preservePermissions": {
      "type": "boolean",
      "description": "Preserve file permissions (Unix-based systems)",
      "default": true
    },
    "stripPrefix": {
      "type": "string",
      "description": "Remove prefix from archive paths (e.g., 'dist/apps/myapp')",
      "examples": ["dist/apps/web-app", "build/output"]
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata to include in artifact manifest (.artifact-metadata.json)",
      "additionalProperties": true
    }
  }
}
